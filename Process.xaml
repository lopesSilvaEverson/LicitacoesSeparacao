<Activity mc:Ignorable="sap sap2010" x:Class="Process" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:p="http://schemas.uipath.com/workflow/activities/word" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:upap="clr-namespace:UiPath.PDF.Activities.PDF;assembly=UiPath.PDF.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property sap2010:Annotation.AnnotationText="Transaction item to be processed." Name="in_TransactionItem" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property sap2010:Annotation.AnnotationText="Dictionary structure to store configuration data of the process (settings, constants and assets)." Name="in_Config" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property Name="in_Licitacoes_Dictionary" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property Name="LogWrite" Type="InArgument(s:Action(x:String))" />
    <x:Property Name="AnalistaLogWrite" Type="InArgument(s:Action(x:String))" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1314,801</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>ProcessTransaction_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="60">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Word.Activities</x:String>
      <x:String>UiPath.PDF.Activities.PDF</x:String>
      <x:String>iTextSharp.text.pdf</x:String>
      <x:String>iTextSharp.text</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Reflection</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="58">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.Word</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>UiPath.Word.Activities</AssemblyReference>
      <AssemblyReference>UiPath.PDF.Activities</AssemblyReference>
      <AssemblyReference>itextsharp</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldExpandAll">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Flowchart DisplayName="Processo Licitacoes" sap:VirtualizedContainerService.HintSize="754,636" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="x:String" Default="[in_Licitacoes_Dictionary(&quot;analistas&quot;).ToString + &quot;/_&quot; + in_TransactionItem(&quot;analista&quot;).ToString.Split(&quot; &quot;c)(0)+ &quot;/&quot; + System.DateTime.Now.Year.ToString  + &quot;/&quot; + in_TransactionItem(&quot;modalidade&quot;).ToString + &quot;/&quot; + in_TransactionItem(&quot;numProcesso&quot;).ToString.Split(&quot;/&quot;c)(0) + &quot; - &quot; + in_TransactionItem(&quot;razaoSocial&quot;).toString]" Name="pathProcesso" />
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
        <av:Size x:Key="ShapeSize">60,75</av:Size>
        <x:Double x:Key="Width">720</x:Double>
        <av:PointCollection x:Key="ConnectorLocation">330,40 580,40 580,64.5</av:PointCollection>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID47</x:Reference>
    </Flowchart.StartNode>
    <FlowStep x:Name="__ReferenceID44">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">200,107</av:Point>
          <av:Size x:Key="ShapeSize">200,66</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">400,140 580,140 580,164.5</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Sequence DisplayName="Cria a pasta de destino" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1">
        <Sequence.Variables>
          <Variable x:TypeArguments="x:Boolean" Name="pathExists" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ui:PathExists DisplayName="Path Exists" Exists="[pathExists]" sap:VirtualizedContainerService.HintSize="484,89" sap2010:WorkflowViewState.IdRef="PathExists_1" Path="[pathProcesso]" PathType="Folder" />
        <If Condition="[not pathExists]" sap:VirtualizedContainerService.HintSize="484,227" sap2010:WorkflowViewState.IdRef="If_3">
          <If.Then>
            <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="Create Folder" sap:VirtualizedContainerService.HintSize="334,79" sap2010:WorkflowViewState.IdRef="CreateDirectory_1" Path="[pathProcesso]" />
          </If.Then>
        </If>
      </Sequence>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID46">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">480,164.5</av:Point>
              <av:Size x:Key="ShapeSize">200,51</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">480,190 300,190 300,216.5</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:InvokeCode ContinueOnError="{x:Null}" Code="AnalistaLogWrite(message);" DisplayName="Private: Invoke code" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_10" Language="CSharp">
            <ui:InvokeCode.Arguments>
              <InOutArgument x:TypeArguments="s:Action(x:String)" x:Key="AnalistaLogWrite">
                <mva:VisualBasicReference x:TypeArguments="s:Action(x:String)" ExpressionText="AnalistaLogWrite" />
              </InOutArgument>
              <InArgument x:TypeArguments="x:String" x:Key="message">
                <Literal x:TypeArguments="x:String">Pasta de destino criado</Literal>
              </InArgument>
            </ui:InvokeCode.Arguments>
          </ui:InvokeCode>
          <FlowStep.Next>
            <FlowDecision x:Name="__ReferenceID39" Condition="[in_TransactionItem(&quot;status&quot;).ToString.Equals(&quot;Separar&quot;)]" DisplayName="Precisa processar?" sap:VirtualizedContainerService.HintSize="101,87" sap2010:WorkflowViewState.IdRef="FlowDecision_1">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <av:Point x:Key="ShapeLocation">249.5,216.5</av:Point>
                  <av:Size x:Key="ShapeSize">101,87</av:Size>
                  <av:PointCollection x:Key="FalseConnector">350.5,260 530,260 530,369</av:PointCollection>
                  <av:PointCollection x:Key="TrueConnector">249.5,260 220,260 220,270</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <FlowDecision.True>
                <FlowStep x:Name="__ReferenceID43">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">20,244.5</av:Point>
                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">120,295.5 120,354.5</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:InvokeCode ContinueOnError="{x:Null}" Code="AnalistaLogWrite(message);" DisplayName="Private: Invoke code" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_7" Language="CSharp">
                    <ui:InvokeCode.Arguments>
                      <InOutArgument x:TypeArguments="s:Action(x:String)" x:Key="AnalistaLogWrite">
                        <mva:VisualBasicReference x:TypeArguments="s:Action(x:String)" ExpressionText="AnalistaLogWrite" />
                      </InOutArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="message">
                        <Literal x:TypeArguments="x:String">Separar documentos</Literal>
                      </InArgument>
                    </ui:InvokeCode.Arguments>
                  </ui:InvokeCode>
                  <FlowStep.Next>
                    <FlowStep x:Name="__ReferenceID42">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">20,354.5</av:Point>
                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">120,405.5 120,435.5 110,435.5 110,454.5</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[CType(in_TransactionItem(&quot;tabelaParametrizacao&quot;), DataTable)]" DisplayName="Separa os documentos" sap:VirtualizedContainerService.HintSize="874,1695" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                        <ui:ForEachRow.Body>
                          <ActivityAction x:TypeArguments="sd:DataRow">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                            </ActivityAction.Argument>
                            <Flowchart DisplayName="Separa os documentos" sap:VirtualizedContainerService.HintSize="914,1547" sap2010:WorkflowViewState.IdRef="Flowchart_6">
                              <Flowchart.Variables>
                                <Variable x:TypeArguments="x:String" Name="originalDocPath" />
                                <Variable x:TypeArguments="x:String" Name="documentName" />
                                <Variable x:TypeArguments="x:String" Default="[pathProcesso + &quot;/&quot; + row.Item(&quot;Divisão do Documento&quot;).ToString]" Name="finalDirectoryPath" />
                                <Variable x:TypeArguments="x:Int32" Name="destinationFilesCount" />
                                <Variable x:TypeArguments="x:Boolean" Name="existSubPath" />
                                <Variable x:TypeArguments="s:String[]" Name="realDocumentArr" />
                                <Variable x:TypeArguments="x:Boolean" Name="matchedRegex" />
                                <Variable x:TypeArguments="x:String" Name="realDocumentName" />
                              </Flowchart.Variables>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                  <av:Size x:Key="ShapeSize">60,75</av:Size>
                                  <x:Double x:Key="Height">1511</x:Double>
                                  <x:Double x:Key="Width">880</x:Double>
                                  <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,107.5 280,107.5 280,127</av:PointCollection>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Flowchart.StartNode>
                                <x:Reference>__ReferenceID13</x:Reference>
                              </Flowchart.StartNode>
                              <FlowStep x:Name="__ReferenceID0">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">0,677</av:Point>
                                    <av:Size x:Key="ShapeSize">200,66</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">100,743 100,773 330,773 330,797</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Sequence DisplayName="Seta Path da declaracao" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_18">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[originalDocPath]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[in_TransactionItem("caminhoDeclaracoes").toString]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                                <FlowStep.Next>
                                  <FlowStep x:Name="__ReferenceID1">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <av:Point x:Key="ShapeLocation">230,797</av:Point>
                                        <av:Size x:Key="ShapeSize">200,66</av:Size>
                                        <av:PointCollection x:Key="ConnectorLocation">330,863 330,916.5</av:PointCollection>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Sequence DisplayName="existe documento REGEX" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_29">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="611,60" sap2010:WorkflowViewState.IdRef="Assign_10">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="s:String[]">[realDocumentArr]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="s:String[]">[System.IO.Directory.GetFiles(originalDocPath,String.Format("*{0}*", documentName))]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <If Condition="[realDocumentArr.Length =1]" sap:VirtualizedContainerService.HintSize="611,400" sap2010:WorkflowViewState.IdRef="If_4">
                                        <If.Then>
                                          <Sequence sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_30">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_11">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Boolean">[matchedRegex]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_12">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[realDocumentName]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[Path.GetFileName(realDocumentArr.First)]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </Sequence>
                                        </If.Then>
                                        <If.Else>
                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_13">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Boolean">[matchedRegex]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Else>
                                      </If>
                                    </Sequence>
                                    <FlowStep.Next>
                                      <FlowDecision x:Name="__ReferenceID10" Condition="[matchedRegex]" DisplayName="Documento existe?" sap:VirtualizedContainerService.HintSize="106,87" sap2010:WorkflowViewState.IdRef="FlowDecision_10">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <av:Point x:Key="ShapeLocation">277,916.5</av:Point>
                                            <av:Size x:Key="ShapeSize">106,87</av:Size>
                                            <av:PointCollection x:Key="TrueConnector">277,960 230,960 230,1057</av:PointCollection>
                                            <av:PointCollection x:Key="FalseConnector">383,960 640,960 640,1069</av:PointCollection>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <FlowDecision.True>
                                          <FlowStep x:Name="__ReferenceID2">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <av:Point x:Key="ShapeLocation">130,1057</av:Point>
                                                <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                <av:PointCollection x:Key="ConnectorLocation">230,1123 230,1196.5</av:PointCollection>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Sequence DisplayName="Copia Documento" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_19">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign sap:VirtualizedContainerService.HintSize="384,60" sap2010:WorkflowViewState.IdRef="Assign_7">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[destinationFilesCount]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">[Directory.GetFiles(finalDirectoryPath, "*.pdf").Length + 1]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <ui:CopyFile ContinueOnError="{x:Null}" Destination="[finalDirectoryPath +&quot;\&quot; + destinationFilesCount.ToString + &quot; - &quot; + realDocumentName]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="CopyFile_3" Overwrite="True" Path="[originalDocPath + &quot;\&quot; + realDocumentName]" />
                                            </Sequence>
                                            <FlowStep.Next>
                                              <FlowDecision x:Name="__ReferenceID4" Condition="[realDocumentName.Contains(&quot;.docx&quot;)]" DisplayName="Documento eh word?" sap:VirtualizedContainerService.HintSize="120,87" sap2010:WorkflowViewState.IdRef="FlowDecision_5">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <av:Point x:Key="ShapeLocation">170,1196.5</av:Point>
                                                    <av:Size x:Key="ShapeSize">120,87</av:Size>
                                                    <av:PointCollection x:Key="TrueConnector">170,1240 100,1240 100,1367</av:PointCollection>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <FlowDecision.True>
                                                  <FlowStep x:Name="__ReferenceID5">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <av:Point x:Key="ShapeLocation">0,1367</av:Point>
                                                        <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Sequence DisplayName="Faz uma copia em pdf" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_20">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <p:WordApplicationScope DisplayName="Word Application Scope" FilePath="[finalDirectoryPath +&quot;/&quot; + destinationFilesCount.ToString + &quot; - &quot; + realDocumentName]" sap:VirtualizedContainerService.HintSize="524,285" sap2010:WorkflowViewState.IdRef="WordApplicationScope_1">
                                                        <p:WordApplicationScope.Body>
                                                          <ActivityAction x:TypeArguments="ui:WordDocument">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="ui:WordDocument" Name="WordDocumentScope" />
                                                            </ActivityAction.Argument>
                                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="476,176" sap2010:WorkflowViewState.IdRef="Sequence_23">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <p:WordExportToPdf DisplayName="Export To PDF" FilePath="[finalDirectoryPath +&quot;/&quot; + destinationFilesCount.ToString + &quot; - &quot; + realDocumentName.Replace(&quot;docx&quot;, &quot;pdf&quot;)]" sap:VirtualizedContainerService.HintSize="434,84" sap2010:WorkflowViewState.IdRef="WordExportToPdf_1" />
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </p:WordApplicationScope.Body>
                                                      </p:WordApplicationScope>
                                                    </Sequence>
                                                  </FlowStep>
                                                </FlowDecision.True>
                                              </FlowDecision>
                                            </FlowStep.Next>
                                          </FlowStep>
                                        </FlowDecision.True>
                                        <FlowDecision.False>
                                          <FlowStep x:Name="__ReferenceID11">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <av:Point x:Key="ShapeLocation">540,1069</av:Point>
                                                <av:Size x:Key="ShapeSize">200,22</av:Size>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Throw Exception="[new BusinessRuleException(&quot;Nao separado, Documento nao existe ou regex esta encontrando mais de um arquivo&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_5">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </Throw>
                                          </FlowStep>
                                        </FlowDecision.False>
                                      </FlowDecision>
                                    </FlowStep.Next>
                                  </FlowStep>
                                </FlowStep.Next>
                              </FlowStep>
                              <FlowDecision x:Name="__ReferenceID6" Condition="[row.Item(&quot;Lista de Documentos&quot;).ToString.ToUpper.Contains(&quot;Declaração&quot;.ToUpper)]" DisplayName="Eh declaracao?" sap:VirtualizedContainerService.HintSize="84,87" sap2010:WorkflowViewState.IdRef="FlowDecision_6" True="{x:Reference __ReferenceID0}">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <av:Point x:Key="ShapeLocation">228,576.5</av:Point>
                                    <av:Size x:Key="ShapeSize">84,87</av:Size>
                                    <av:PointCollection x:Key="TrueConnector">228,620 100,620 100,677</av:PointCollection>
                                    <av:PointCollection x:Key="FalseConnector">312,620 480,620 480,677</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <FlowDecision.False>
                                  <FlowStep x:Name="__ReferenceID3">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <av:Point x:Key="ShapeLocation">380,677</av:Point>
                                        <av:Size x:Key="ShapeSize">200,66</av:Size>
                                        <av:PointCollection x:Key="ConnectorLocation">480,743 480,773 330,773 330,797</av:PointCollection>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Sequence DisplayName="Seta Path da base de documentos" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_21">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[originalDocPath]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String" xml:space="preserve">[in_Licitacoes_Dictionary("documentos").ToString + "/"  + row.Item("Empresa").ToString]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                    <FlowStep.Next>
                                      <x:Reference>__ReferenceID1</x:Reference>
                                    </FlowStep.Next>
                                  </FlowStep>
                                </FlowDecision.False>
                              </FlowDecision>
                              <x:Reference>__ReferenceID2</x:Reference>
                              <x:Reference>__ReferenceID3</x:Reference>
                              <x:Reference>__ReferenceID4</x:Reference>
                              <x:Reference>__ReferenceID5</x:Reference>
                              <FlowStep x:Name="__ReferenceID9">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">260,264.5</av:Point>
                                    <av:Size x:Key="ShapeSize">200,51</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">360,315.5 360,345.5 370,345.5 370,376.5</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:PathExists DisplayName="existe subpasta" Exists="[existSubPath]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="PathExists_2" Path="[finalDirectoryPath]" PathType="Folder">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:PathExists>
                                <FlowStep.Next>
                                  <FlowDecision x:Name="__ReferenceID7" Condition="[existSubPath]" DisplayName="Existe a subpasta?" sap:VirtualizedContainerService.HintSize="99,87" sap2010:WorkflowViewState.IdRef="FlowDecision_8" True="{x:Reference __ReferenceID6}">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <av:Point x:Key="ShapeLocation">320.5,376.5</av:Point>
                                        <av:Size x:Key="ShapeSize">99,87</av:Size>
                                        <av:PointCollection x:Key="TrueConnector">320.5,420 270,420 270,576.5</av:PointCollection>
                                        <av:PointCollection x:Key="FalseConnector">419.5,420 570,420 570,454.5</av:PointCollection>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <FlowDecision.False>
                                      <FlowStep x:Name="__ReferenceID8">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <av:Point x:Key="ShapeLocation">470,454.5</av:Point>
                                            <av:Size x:Key="ShapeSize">200,51</av:Size>
                                            <av:PointCollection x:Key="ConnectorLocation">570,505.5 570,524.5</av:PointCollection>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="Create Folder" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="CreateDirectory_2" Path="[finalDirectoryPath]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CreateDirectory>
                                        <FlowStep.Next>
                                          <FlowStep x:Name="__ReferenceID12">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <av:Point x:Key="ShapeLocation">470,524.5</av:Point>
                                                <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                <av:PointCollection x:Key="ConnectorLocation">470,550 270,550 270,576.5</av:PointCollection>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:InvokeCode ContinueOnError="{x:Null}" Code="AnalistaLogWrite(message);" DisplayName="Private: Invoke code" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_11" Language="CSharp">
                                              <ui:InvokeCode.Arguments>
                                                <InOutArgument x:TypeArguments="s:Action(x:String)" x:Key="AnalistaLogWrite">
                                                  <mva:VisualBasicReference x:TypeArguments="s:Action(x:String)" ExpressionText="AnalistaLogWrite" />
                                                </InOutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="message">
                                                  <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="&quot;Criando subpasta &quot; + finalDirectoryPath" />
                                                </InArgument>
                                              </ui:InvokeCode.Arguments>
                                            </ui:InvokeCode>
                                            <FlowStep.Next>
                                              <x:Reference>__ReferenceID6</x:Reference>
                                            </FlowStep.Next>
                                          </FlowStep>
                                        </FlowStep.Next>
                                      </FlowStep>
                                    </FlowDecision.False>
                                  </FlowDecision>
                                </FlowStep.Next>
                              </FlowStep>
                              <x:Reference>__ReferenceID7</x:Reference>
                              <x:Reference>__ReferenceID8</x:Reference>
                              <FlowStep x:Name="__ReferenceID13">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">180,127</av:Point>
                                    <av:Size x:Key="ShapeSize">200,66</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">280,193 280,223 360,223 360,264.5</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Sequence DisplayName="Inicializa variaveis" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_22">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_5">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[documentName]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[in_Licitacoes_Dictionary(row.Item("Lista de Documentos").ToString).ToString]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                                <FlowStep.Next>
                                  <x:Reference>__ReferenceID9</x:Reference>
                                </FlowStep.Next>
                              </FlowStep>
                              <x:Reference>__ReferenceID10</x:Reference>
                              <x:Reference>__ReferenceID11</x:Reference>
                              <x:Reference>__ReferenceID1</x:Reference>
                              <x:Reference>__ReferenceID12</x:Reference>
                              <FlowStep>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">660,784.5</av:Point>
                                    <av:Size x:Key="ShapeSize">200,51</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">490,100 310,100 310,117</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:InvokeCode ContinueOnError="{x:Null}" Code="AnalistaLogWrite(message);" DisplayName="Private: Invoke code" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_12" Language="CSharp">
                                  <ui:InvokeCode.Arguments>
                                    <InOutArgument x:TypeArguments="s:Action(x:String)" x:Key="AnalistaLogWrite">[AnalistaLogWrite]</InOutArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="message">Criar pasta de destino</InArgument>
                                  </ui:InvokeCode.Arguments>
                                </ui:InvokeCode>
                              </FlowStep>
                              <FlowStep>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">0,854.5</av:Point>
                                    <av:Size x:Key="ShapeSize">200,51</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">490,100 310,100 310,117</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:InvokeCode ContinueOnError="{x:Null}" Code="AnalistaLogWrite(message);" DisplayName="Private: Invoke code" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_13" Language="CSharp">
                                  <ui:InvokeCode.Arguments>
                                    <InOutArgument x:TypeArguments="s:Action(x:String)" x:Key="AnalistaLogWrite">[AnalistaLogWrite]</InOutArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="message">Criar pasta de destino</InArgument>
                                  </ui:InvokeCode.Arguments>
                                </ui:InvokeCode>
                              </FlowStep>
                            </Flowchart>
                          </ActivityAction>
                        </ui:ForEachRow.Body>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ForEachRow>
                      <FlowStep.Next>
                        <FlowStep x:Name="__ReferenceID45">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">10,454.5</av:Point>
                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">110,505.5 110,540 210,540</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:InvokeCode ContinueOnError="{x:Null}" Code="AnalistaLogWrite(message);" DisplayName="Private: Invoke code" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_9" Language="CSharp">
                            <ui:InvokeCode.Arguments>
                              <InOutArgument x:TypeArguments="s:Action(x:String)" x:Key="AnalistaLogWrite">
                                <mva:VisualBasicReference x:TypeArguments="s:Action(x:String)" ExpressionText="AnalistaLogWrite" />
                              </InOutArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="message">
                                <Literal x:TypeArguments="x:String">Separado</Literal>
                              </InArgument>
                            </ui:InvokeCode.Arguments>
                          </ui:InvokeCode>
                          <FlowStep.Next>
                            <FlowStep x:Name="__ReferenceID41">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">210,514.5</av:Point>
                                  <av:Size x:Key="ShapeSize">200,51</av:Size>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Flowchart DisplayName="Finaliza o processo" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Flowchart_3">
                                <Flowchart.Variables>
                                  <Variable x:TypeArguments="scg:List(x:String)" Default="[new List(of String)]" Name="generatedFiles" />
                                  <Variable x:TypeArguments="x:String" Name="lastFileBeforeSplit" />
                                  <Variable x:TypeArguments="x:String" Name="finalPath" />
                                  <Variable x:TypeArguments="x:Int32" Name="pageCount" />
                                  <Variable x:TypeArguments="x:String" Name="finalFilename" />
                                </Flowchart.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                    <av:Size x:Key="ShapeSize">60,75</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,116.5</av:PointCollection>
                                    <x:Double x:Key="Height">1215</x:Double>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Flowchart.StartNode>
                                  <x:Reference>__ReferenceID38</x:Reference>
                                </Flowchart.StartNode>
                                <FlowStep x:Name="__ReferenceID30">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">390,264.5</av:Point>
                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">490,315.5 490,427</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:ForEach x:TypeArguments="x:Object" CurrentIndex="{x:Null}" DisplayName="Unifica o arquivo em cada subpasta" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_1" Values="[Directory.GetDirectories(pathProcesso)]">
                                    <ui:ForEach.Body>
                                      <ActivityAction x:TypeArguments="x:Object">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="x:Object" Name="subFolder" />
                                        </ActivityAction.Argument>
                                        <Sequence sap:VirtualizedContainerService.HintSize="858,1506" sap2010:WorkflowViewState.IdRef="Sequence_28">
                                          <Sequence.Variables>
                                            <Variable x:TypeArguments="x:String" Name="lastFileBeforeSplit" />
                                          </Sequence.Variables>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Flowchart sap:VirtualizedContainerService.HintSize="816,1414" sap2010:WorkflowViewState.IdRef="Flowchart_7">
                                            <Flowchart.Variables>
                                              <Variable x:TypeArguments="x:Int32" Name="pageCount" />
                                              <Variable x:TypeArguments="x:String" Name="finalPath" />
                                            </Flowchart.Variables>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                                <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,147</av:PointCollection>
                                                <x:Double x:Key="Height">1377.632</x:Double>
                                                <x:Double x:Key="Width">782</x:Double>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Flowchart.StartNode>
                                              <x:Reference>__ReferenceID19</x:Reference>
                                            </Flowchart.StartNode>
                                            <FlowStep x:Name="__ReferenceID14">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">190,787</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence DisplayName=" copia para pasta do analista" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_25">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="384,51" sap2010:WorkflowViewState.IdRef="CommentOut_4">
                                                  <ui:CommentOut.Body>
                                                    <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="426,249" sap2010:WorkflowViewState.IdRef="Sequence_58">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:CopyFile ContinueOnError="{x:Null}" Destination="[pathProcesso +  &quot;/1-&quot; + pageCount.ToString +&quot; &quot; + subFolder.ToString.Split({&quot;\&quot;c, &quot;/&quot;c}).Last  + &quot;.pdf&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="CopyFile_2" Overwrite="True" Path="[finalPath]" />
                                                    </Sequence>
                                                  </ui:CommentOut.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:CommentOut>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[pathProcesso +  &quot;/1-&quot; + pageCount.ToString +&quot; &quot; + subFolder.ToString.Split({&quot;\&quot;c, &quot;/&quot;c}).Last  + &quot;.pdf&quot;]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_9" Overwrite="True" Path="[finalPath]" />
                                                <Assign sap:VirtualizedContainerService.HintSize="384,60" sap2010:WorkflowViewState.IdRef="Assign_14">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[lastFileBeforeSplit]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String" xml:space="preserve">[pathProcesso +  "/1-" + pageCount.ToString +" " + subFolder.ToString.Split({"\"c, "/"c}).Last  + ".pdf"]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                            </FlowStep>
                                            <FlowStep x:Name="__ReferenceID15">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">200,677</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">300,743 300,773 290,773 290,787</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence DisplayName="Adiciona numero das paginas" sap:VirtualizedContainerService.HintSize="426,553" sap2010:WorkflowViewState.IdRef="Sequence_26">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="x:String" Name="analistaIniciais" />
                                                  <Variable x:TypeArguments="x:String" Default="[in_TransactionItem(&quot;analista&quot;).ToString.Split(&quot; &quot;c)(0)]" Name="analistaNome" />
                                                  <Variable x:TypeArguments="x:String" Default="[in_TransactionItem(&quot;analista&quot;).ToString.Split(&quot; &quot;c)(1)]" Name="analistaSobrenome" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="384,60" sap2010:WorkflowViewState.IdRef="Assign_9">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[analistaIniciais]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[analistaNome(0) + analistaSobrenome(0)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <ui:InvokeCode ContinueOnError="{x:Null}" Code="&#xA;&#x9;&#x9;//public static void AddTextToPdf(string inputPdfPath, string outputPdfPath, string textToAdd, System.Drawing.Point point)&#xA;    &#xA;        //variables&#xA;&#x9;&#x9;System.Drawing.Point point = new Point(10,10);&#xA;&#x9;    string pathin = inputPdfPath;&#xA;        string pathout = outputPdfPath;&#xA;&#xA;        //create PdfReader object to read from the existing document&#xA;        using (PdfReader reader = new PdfReader(pathin))&#xA;        //create PdfStamper object to write to get the pages from reader &#xA;        using (PdfStamper stamper = new PdfStamper(reader, new FileStream(pathout, FileMode.Create)))&#xA;        {&#xA;&#x9;&#x9;&#x9;  for (var i = 1; i &lt;= reader.NumberOfPages; i++){&#xA;&#x9;&#x9;&#x9;  &#x9;&#xA;&#x9;&#x9;&#x9;&#xA;            //select two pages from the original document&#xA;          //  reader.SelectPages(&quot;1-2&quot;);&#xA;&#xA;            //gettins the page size in order to substract from the iTextSharp coordinates&#xA;            var pageSize = reader.GetPageSize(i);&#xA;&#xA;            // PdfContentByte from stamper to add content to the pages over the original content&#xA;            PdfContentByte pbover = stamper.GetOverContent(i);&#xA;&#xA;            //add content to the page using ColumnText&#xA;            iTextSharp.text.Font font = new  iTextSharp.text.Font();&#xA;            font.Size = 6;&#xA;&#xA;            //setting up the X and Y coordinates of the document&#xA;            int x = point.X;&#xA;            int y = point.Y;&#xA;&#xA;            y = (int) (pageSize.Height - y);&#xA;&#xA;            ColumnText.ShowTextAligned(pbover, Element.ALIGN_CENTER, new Phrase(i.ToString() + &quot; - &quot; + textToAdd, font), x, y, 0);&#xA;        }&#xA;&#x9;&#x9;&#x9;    }&#xA;    " DisplayName="Invoke code" sap:VirtualizedContainerService.HintSize="384,164" sap2010:WorkflowViewState.IdRef="InvokeCode_1" Language="CSharp">
                                                  <ui:InvokeCode.Arguments>
                                                    <InArgument x:TypeArguments="x:String" x:Key="textToAdd">[analistaIniciais]</InArgument>
                                                    <InArgument x:TypeArguments="x:String" x:Key="inputPdfPath">[finalPath]</InArgument>
                                                    <InArgument x:TypeArguments="x:String" x:Key="outputPdfPath">[finalPath+"count.pdf"]</InArgument>
                                                  </ui:InvokeCode.Arguments>
                                                </ui:InvokeCode>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[finalPath]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_2" Overwrite="True" Path="[finalPath+&quot;count.pdf&quot;]" />
                                              </Sequence>
                                              <FlowStep.Next>
                                                <x:Reference>__ReferenceID14</x:Reference>
                                              </FlowStep.Next>
                                            </FlowStep>
                                            <FlowStep x:Name="__ReferenceID19">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">200,147</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">300,213 300,294.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence DisplayName="Faz merge dos PDF`s" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_27">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <upap:JoinPDF DisplayName="Join PDF Files" FileList="[Directory.GetFiles(subFolder.ToString, &quot;*.pdf&quot;)]" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="JoinPDF_2" OutputFileName="[subFolder.ToString + &quot;/&quot; + &quot;final.pdf&quot;]" />
                                              </Sequence>
                                              <FlowStep.Next>
                                                <FlowStep x:Name="__ReferenceID16">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">200,294.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">300,345.5 300,410</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <upap:GetPDFPageCount DisplayName="Get PDF Page Count" FileName="[subFolder.ToString + &quot;/&quot; + &quot;final.pdf&quot;]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="GetPDFPageCount_1" PageCount="[pageCount]">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </upap:GetPDFPageCount>
                                                  <FlowStep.Next>
                                                    <FlowStep x:Name="__ReferenceID18">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">169,410</av:Point>
                                                          <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">300,470 300,534.5</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_8">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[finalPath]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String" xml:space="preserve">[subFolder.ToString + "/" + "1-" + pageCount.ToString +" " + subFolder.ToString.Split({"\"c, "/"c}).Last  + ".pdf"]</InArgument>
                                                        </Assign.Value>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </Assign>
                                                      <FlowStep.Next>
                                                        <FlowStep x:Name="__ReferenceID17">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">200,534.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">300,585.5 300,677</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:MoveFile ContinueOnError="{x:Null}" Destination="[finalPath]" DisplayName="Rename File" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_1" Overwrite="True" Path="[subFolder.ToString + &quot;\&quot; + &quot;final.pdf&quot;]">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:MoveFile>
                                                          <FlowStep.Next>
                                                            <x:Reference>__ReferenceID15</x:Reference>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowStep.Next>
                                            </FlowStep>
                                            <x:Reference>__ReferenceID16</x:Reference>
                                            <x:Reference>__ReferenceID17</x:Reference>
                                            <x:Reference>__ReferenceID18</x:Reference>
                                            <FlowStep>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">290,1314.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:CommentOut sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="CommentOut_1">
                                                <ui:CommentOut.Body>
                                                  <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="676,728" sap2010:WorkflowViewState.IdRef="Sequence_32">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Flowchart DisplayName="Quebra o arquivo" sap:VirtualizedContainerService.HintSize="634,636" sap2010:WorkflowViewState.IdRef="Flowchart_8">
                                                      <Flowchart.Variables>
                                                        <Variable x:TypeArguments="x:Boolean" Default="False" Name="allMatchSize" />
                                                      </Flowchart.Variables>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Flowchart.StartNode>
                                                        <x:Null />
                                                      </Flowchart.StartNode>
                                                      <FlowStep>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <av:Point x:Key="ShapeLocation">200,164.5</av:Point>
                                                            <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:InterruptibleWhile Condition="[Not allMatchSize]" DisplayName="While" sap:VirtualizedContainerService.HintSize="556,505" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_1">
                                                          <ui:InterruptibleWhile.Body>
                                                            <ui:ForEach x:TypeArguments="x:Object" CurrentIndex="{x:Null}" sap:VirtualizedContainerService.HintSize="520,340" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[Directory.GetFIles(pathProcesso)]">
                                                              <ui:ForEach.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="file" />
                                                                  </ActivityAction.Argument>
                                                                  <If Condition="[System.IO.FileInfo(file).Length &gt; (Convert.ToInt32(in_Config.(&quot;maxPdfSize&quot;)) * 1024 * 1024)]" sap:VirtualizedContainerService.HintSize="484,207" sap2010:WorkflowViewState.IdRef="If_5" />
                                                                </ActivityAction>
                                                              </ui:ForEach.Body>
                                                            </ui:ForEach>
                                                          </ui:InterruptibleWhile.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:InterruptibleWhile>
                                                      </FlowStep>
                                                    </Flowchart>
                                                  </Sequence>
                                                </ui:CommentOut.Body>
                                              </ui:CommentOut>
                                            </FlowStep>
                                          </Flowchart>
                                        </Sequence>
                                      </ActivityAction>
                                    </ui:ForEach.Body>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:ForEach>
                                  <FlowStep.Next>
                                    <FlowStep x:Name="__ReferenceID20">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">390,427</av:Point>
                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:CommentOut sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="CommentOut_3">
                                        <ui:CommentOut.Body>
                                          <Sequence DisplayName="Ignored Activities" sap2010:WorkflowViewState.IdRef="Sequence_57">
                                            <Sequence DisplayName="Remove os arquivos intermediarios" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_37">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:ForEach x:TypeArguments="x:Object" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="307,248" sap2010:WorkflowViewState.IdRef="ForEach`1_4" Values="[Directory.GetDirectories(pathProcesso)]">
                                                <ui:ForEach.Body>
                                                  <ActivityAction x:TypeArguments="x:Object">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="x:Object" Name="item" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="242,114" sap2010:WorkflowViewState.IdRef="Sequence_36">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:Delete ContinueOnError="True" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delete_2" Path="[item.toString]" />
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:ForEach.Body>
                                              </ui:ForEach>
                                            </Sequence>
                                          </Sequence>
                                        </ui:CommentOut.Body>
                                      </ui:CommentOut>
                                    </FlowStep>
                                  </FlowStep.Next>
                                </FlowStep>
                                <x:Reference>__ReferenceID20</x:Reference>
                                <FlowDecision x:Name="__ReferenceID38" Condition="[in_TransactionItem(&quot;modalidade&quot;).ToString.Equals(&quot;Pregão Eletrônico&quot;, StringComparison.InvariantCultureIgnoreCase)]" DisplayName="eh eletronico?" sap:VirtualizedContainerService.HintSize="80,87" sap2010:WorkflowViewState.IdRef="FlowDecision_12">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <av:Point x:Key="ShapeLocation">260,116.5</av:Point>
                                      <av:Size x:Key="ShapeSize">80,87</av:Size>
                                      <av:PointCollection x:Key="FalseConnector">340,160 490,160 490,264.5</av:PointCollection>
                                      <av:PointCollection x:Key="TrueConnector">260,160 140,160 140,254.5</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <FlowDecision.True>
                                    <FlowStep x:Name="__ReferenceID32">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">40,254.5</av:Point>
                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">140,305.5 140,327</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:ForEach x:TypeArguments="x:Object" CurrentIndex="{x:Null}" DisplayName="Unifica o arquivo em cada subpasta" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_6" Values="[Directory.GetDirectories(pathProcesso)]">
                                        <ui:ForEach.Body>
                                          <ActivityAction x:TypeArguments="x:Object">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="x:Object" Name="subFolder" />
                                            </ActivityAction.Argument>
                                            <Sequence sap:VirtualizedContainerService.HintSize="242,143" sap2010:WorkflowViewState.IdRef="Sequence_45">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Flowchart sap:VirtualizedContainerService.HintSize="816,1414" sap2010:WorkflowViewState.IdRef="Flowchart_10">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                                    <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                    <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,147</av:PointCollection>
                                                    <x:Double x:Key="Height">1377.632</x:Double>
                                                    <x:Double x:Key="Width">782</x:Double>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Flowchart.StartNode>
                                                  <x:Reference>__ReferenceID23</x:Reference>
                                                </Flowchart.StartNode>
                                                <FlowStep x:Name="__ReferenceID23">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">200,147</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">300,213 300,324.5</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Sequence DisplayName="Faz merge dos PDF`s" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_41">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <upap:JoinPDF DisplayName="Join PDF Files" FileList="[Directory.GetFiles(subFolder.ToString, &quot;*.pdf&quot;)]" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="JoinPDF_3" OutputFileName="[subFolder.ToString + &quot;/&quot; + &quot;final.pdf&quot;]" />
                                                  </Sequence>
                                                  <FlowStep.Next>
                                                    <FlowStep x:Name="__ReferenceID21">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">200,324.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">300,375.5 300,419</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:MoveFile ContinueOnError="{x:Null}" Destination="[pathProcesso + &quot;\&quot; + subFolder.ToString.Split({&quot;\&quot;c, &quot;/&quot;c}).Last  + &quot;.pdf&quot;]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_5" Overwrite="True" Path="[subFolder.ToString + &quot;/&quot; + &quot;final.pdf&quot;]">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:MoveFile>
                                                      <FlowStep.Next>
                                                        <FlowStep x:Name="__ReferenceID22">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">200,419</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <AddToCollection x:TypeArguments="x:String" Collection="[generatedFiles]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_1" Item="[subFolder.ToString + &quot;.pdf&quot;]" />
                                                        </FlowStep>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                                <x:Reference>__ReferenceID21</x:Reference>
                                                <x:Reference>__ReferenceID22</x:Reference>
                                              </Flowchart>
                                            </Sequence>
                                          </ActivityAction>
                                        </ui:ForEach.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ForEach>
                                      <FlowStep.Next>
                                        <FlowStep x:Name="__ReferenceID35">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">40,327</av:Point>
                                              <av:Size x:Key="ShapeSize">200,66</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">140,393 130,393 130,417</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Sequence DisplayName="Faz merge dos PDF`s" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_52">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If Condition="[generatedFiles.Count &gt; 1]" DisplayName="verifica se tem mais de um para mergear" sap:VirtualizedContainerService.HintSize="763,305" sap2010:WorkflowViewState.IdRef="If_6">
                                              <If.Then>
                                                <upap:JoinPDF DisplayName="Join PDF Files" FileList="[generatedFiles.ToArray()]" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="JoinPDF_5" OutputFileName="[pathProcesso.ToString + &quot;/&quot; + &quot;final.pdf&quot;]" />
                                              </If.Then>
                                              <If.Else>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[pathProcesso.ToString + &quot;/&quot; + &quot;final.pdf&quot;]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_6" Overwrite="True" Path="[generatedFiles.First()]" />
                                              </If.Else>
                                            </If>
                                          </Sequence>
                                          <FlowStep.Next>
                                            <FlowStep x:Name="__ReferenceID33">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">30,417</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">130,483 130,513 120,513 120,544.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence DisplayName="Remove os arquivos intermediarios" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_47">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:ForEach x:TypeArguments="x:Object" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="307,248" sap2010:WorkflowViewState.IdRef="ForEach`1_7" Values="[Directory.GetDirectories(pathProcesso)]">
                                                  <ui:ForEach.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="item" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="242,114" sap2010:WorkflowViewState.IdRef="Sequence_46">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:Delete ContinueOnError="True" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delete_3" Path="[item.toString]" />
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:ForEach.Body>
                                                </ui:ForEach>
                                                <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="307,248" sap2010:WorkflowViewState.IdRef="ForEach`1_9" Values="[generatedFiles]">
                                                  <ui:ForEach.Body>
                                                    <ActivityAction x:TypeArguments="x:String">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="242,114" sap2010:WorkflowViewState.IdRef="Sequence_53">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delete_4" Path="[item]" />
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:ForEach.Body>
                                                </ui:ForEach>
                                              </Sequence>
                                              <FlowStep.Next>
                                                <FlowStep x:Name="__ReferenceID36">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">20,544.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">120,595.5 120,625.5 110,625.5 110,656.5</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Flowchart sap:VirtualizedContainerService.HintSize="785,1099" sap2010:WorkflowViewState.IdRef="Flowchart_11">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                                        <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                        <x:Double x:Key="Height">1063</x:Double>
                                                        <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,184.5</av:PointCollection>
                                                        <x:Double x:Key="Width">751</x:Double>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Flowchart.StartNode>
                                                      <x:Reference>__ReferenceID29</x:Reference>
                                                    </Flowchart.StartNode>
                                                    <FlowStep x:Name="__ReferenceID24">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">200,687</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:CommentOut sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="CommentOut_2">
                                                        <ui:CommentOut.Body>
                                                          <Sequence DisplayName="Ignored Activities" sap2010:WorkflowViewState.IdRef="Sequence_56">
                                                            <Sequence DisplayName=" copia para pasta do analista" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_55">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ui:CopyFile ContinueOnError="{x:Null}" Destination="[pathProcesso +  &quot;/1-&quot; + pageCount.ToString +&quot; &quot; + pathProcesso.ToString.Split({&quot;\&quot;c, &quot;/&quot;c}).Last  + &quot;.pdf&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="CopyFile_5" Overwrite="True" Path="[finalPath]" />
                                                              <Assign sap:VirtualizedContainerService.HintSize="384,60" sap2010:WorkflowViewState.IdRef="Assign_20">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:String">[lastFileBeforeSplit]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:String" xml:space="preserve">[pathProcesso +  "/1-" + pageCount.ToString +" " +pathProcesso.ToString.Split({"\"c, "/"c}).Last  + ".pdf"]</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                            </Sequence>
                                                          </Sequence>
                                                        </ui:CommentOut.Body>
                                                      </ui:CommentOut>
                                                    </FlowStep>
                                                    <FlowStep x:Name="__ReferenceID25">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">200,547</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">300,613 300,687</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Sequence DisplayName="Adiciona numero das paginas" sap:VirtualizedContainerService.HintSize="426,553" sap2010:WorkflowViewState.IdRef="Sequence_54">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="x:String" Name="analistaIniciais" />
                                                          <Variable x:TypeArguments="x:String" Default="[in_TransactionItem(&quot;analista&quot;).ToString.Split(&quot; &quot;c)(0)]" Name="analistaNome" />
                                                          <Variable x:TypeArguments="x:String" Default="[in_TransactionItem(&quot;analista&quot;).ToString.Split(&quot; &quot;c)(1)]" Name="analistaSobrenome" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <Assign sap:VirtualizedContainerService.HintSize="384,60" sap2010:WorkflowViewState.IdRef="Assign_19">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[analistaIniciais]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[analistaNome(0) + analistaSobrenome(0)]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <ui:InvokeCode ContinueOnError="{x:Null}" Code="&#xA;&#x9;&#x9;//public static void AddTextToPdf(string inputPdfPath, string outputPdfPath, string textToAdd, System.Drawing.Point point)&#xA;    &#xA;        //variables&#xA;&#x9;&#x9;System.Drawing.Point point = new Point(10,10);&#xA;&#x9;    string pathin = inputPdfPath;&#xA;        string pathout = outputPdfPath;&#xA;&#xA;        //create PdfReader object to read from the existing document&#xA;        using (PdfReader reader = new PdfReader(pathin))&#xA;        //create PdfStamper object to write to get the pages from reader &#xA;        using (PdfStamper stamper = new PdfStamper(reader, new FileStream(pathout, FileMode.Create)))&#xA;        {&#xA;&#x9;&#x9;&#x9;  for (var i = 1; i &lt;= reader.NumberOfPages; i++){&#xA;&#x9;&#x9;&#x9;  &#x9;&#xA;&#x9;&#x9;&#x9;&#xA;            //select two pages from the original document&#xA;          //  reader.SelectPages(&quot;1-2&quot;);&#xA;&#xA;            //gettins the page size in order to substract from the iTextSharp coordinates&#xA;            var pageSize = reader.GetPageSize(i);&#xA;&#xA;            // PdfContentByte from stamper to add content to the pages over the original content&#xA;            PdfContentByte pbover = stamper.GetOverContent(i);&#xA;&#xA;            //add content to the page using ColumnText&#xA;            iTextSharp.text.Font font = new  iTextSharp.text.Font();&#xA;            font.Size = 6;&#xA;&#xA;            //setting up the X and Y coordinates of the document&#xA;            int x = point.X;&#xA;            int y = point.Y;&#xA;&#xA;            y = (int) (pageSize.Height - y);&#xA;&#xA;            ColumnText.ShowTextAligned(pbover, Element.ALIGN_CENTER, new Phrase(i.ToString() + &quot; - &quot; + textToAdd, font), x, y, 0);&#xA;        }&#xA;&#x9;&#x9;&#x9;    }&#xA;    " DisplayName="Invoke code" sap:VirtualizedContainerService.HintSize="384,164" sap2010:WorkflowViewState.IdRef="InvokeCode_5" Language="CSharp">
                                                          <ui:InvokeCode.Arguments>
                                                            <InArgument x:TypeArguments="x:String" x:Key="textToAdd">[analistaIniciais]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="inputPdfPath">[finalPath]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="outputPdfPath">[finalPath+"count.pdf"]</InArgument>
                                                          </ui:InvokeCode.Arguments>
                                                        </ui:InvokeCode>
                                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[finalPath]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_8" Overwrite="True" Path="[finalPath+&quot;count.pdf&quot;]" />
                                                      </Sequence>
                                                      <FlowStep.Next>
                                                        <x:Reference>__ReferenceID24</x:Reference>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                    <FlowStep x:Name="__ReferenceID26">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">200,444.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">300,495.5 300,547</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:MoveFile ContinueOnError="{x:Null}" Destination="[finalPath]" DisplayName="Rename File" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_7" Overwrite="True" Path="[pathProcesso+ &quot;\&quot; + &quot;final.pdf&quot;]">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:MoveFile>
                                                      <FlowStep.Next>
                                                        <x:Reference>__ReferenceID25</x:Reference>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                    <FlowStep x:Name="__ReferenceID27">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">169,350</av:Point>
                                                          <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">300,410 300,444.5</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_18">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[finalPath]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String" xml:space="preserve">[pathProcesso + "/" + "1-" + pageCount.ToString +" Documentos"  + ".pdf"]</InArgument>
                                                        </Assign.Value>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </Assign>
                                                      <FlowStep.Next>
                                                        <x:Reference>__ReferenceID26</x:Reference>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                    <FlowStep x:Name="__ReferenceID29">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">200,184.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">300,235.5 300,260</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <upap:GetPDFPageCount DisplayName="Get PDF Page Count" FileName="[pathProcesso + &quot;/&quot; + &quot;final.pdf&quot;]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="GetPDFPageCount_3" PageCount="[pageCount]">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </upap:GetPDFPageCount>
                                                      <FlowStep.Next>
                                                        <FlowStep x:Name="__ReferenceID28">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">169,260</av:Point>
                                                              <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">300,320 300,350</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_21">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[finalFilename]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String" xml:space="preserve">["1-" + pageCount.ToString +" Documentos"  + ".pdf"]</InArgument>
                                                            </Assign.Value>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </Assign>
                                                          <FlowStep.Next>
                                                            <x:Reference>__ReferenceID27</x:Reference>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                    <x:Reference>__ReferenceID28</x:Reference>
                                                  </Flowchart>
                                                  <FlowStep.Next>
                                                    <FlowDecision x:Name="__ReferenceID31" Condition="[in_TransactionItem(&quot;modalidade&quot;).ToString.Equals(&quot;e-licitacoes&quot;, StringComparison.InvariantCultureIgnoreCase) and (new System.IO.FileInfo(finalPath).Length &gt;= Convert.ToInt32(in_Config(&quot;maxPdfSize&quot;))*1024)]" DisplayName="licitacoes-e?" sap:VirtualizedContainerService.HintSize="71,87" sap2010:WorkflowViewState.IdRef="FlowDecision_13">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          <av:Point x:Key="ShapeLocation">74.5,656.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">71,87</av:Size>
                                                          <av:PointCollection x:Key="TrueConnector">74.5,700 44.5,700 44.5,754.5 130,754.5 130,784.5</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <FlowDecision.True>
                                                        <FlowStep x:Name="__ReferenceID37">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">30,784.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">130,835.5 130,894.5</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:InvokeCode ContinueOnError="{x:Null}" Code="LogWrite(message);" DisplayName="Private: Invoke code" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_6" Language="CSharp">
                                                            <ui:InvokeCode.Arguments>
                                                              <InOutArgument x:TypeArguments="s:Action(x:String)" x:Key="LogWrite">[LogWrite]</InOutArgument>
                                                              <InArgument x:TypeArguments="x:String" x:Key="message">e-licitacoes: TRUE, arquivo sera quebrado</InArgument>
                                                            </ui:InvokeCode.Arguments>
                                                          </ui:InvokeCode>
                                                          <FlowStep.Next>
                                                            <FlowStep x:Name="__ReferenceID34">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">30,894.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke SplitFile workflow" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="SplitFileLinear.xaml">
                                                                <ui:InvokeWorkflowFile.Arguments>
                                                                  <InArgument x:TypeArguments="x:Int32" x:Key="in_maxSize">[Convert.ToInt32(in_Config("maxPdfSize"))]</InArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_fileDirectoryPath">[pathProcesso]</InArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_filename">[finalFIlename]</InArgument>
                                                                </ui:InvokeWorkflowFile.Arguments>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                              </ui:InvokeWorkflowFile>
                                                            </FlowStep>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowDecision.True>
                                                    </FlowDecision>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowStep.Next>
                                            </FlowStep>
                                          </FlowStep.Next>
                                        </FlowStep>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </FlowDecision.True>
                                  <FlowDecision.False>
                                    <x:Reference>__ReferenceID30</x:Reference>
                                  </FlowDecision.False>
                                </FlowDecision>
                                <x:Reference>__ReferenceID31</x:Reference>
                                <x:Reference>__ReferenceID32</x:Reference>
                                <x:Reference>__ReferenceID33</x:Reference>
                                <x:Reference>__ReferenceID34</x:Reference>
                                <x:Reference>__ReferenceID35</x:Reference>
                                <x:Reference>__ReferenceID36</x:Reference>
                                <x:Reference>__ReferenceID37</x:Reference>
                              </Flowchart>
                            </FlowStep>
                          </FlowStep.Next>
                        </FlowStep>
                      </FlowStep.Next>
                    </FlowStep>
                  </FlowStep.Next>
                </FlowStep>
              </FlowDecision.True>
              <FlowDecision.False>
                <FlowStep x:Name="__ReferenceID40">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">430,369</av:Point>
                      <av:Size x:Key="ShapeSize">200,22</av:Size>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Throw DisplayName="Throw status nao era processado" Exception="[New BusinessRuleException(&quot;Nao separado, status do IItem diferente de 'Separar'&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_3" />
                </FlowStep>
              </FlowDecision.False>
            </FlowDecision>
          </FlowStep.Next>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID39</x:Reference>
    <x:Reference>__ReferenceID40</x:Reference>
    <x:Reference>__ReferenceID41</x:Reference>
    <x:Reference>__ReferenceID42</x:Reference>
    <x:Reference>__ReferenceID43</x:Reference>
    <FlowStep x:Name="__ReferenceID47">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">480,64.5</av:Point>
          <av:Size x:Key="ShapeSize">200,51</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">480,90 300,90 300,107</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:InvokeCode ContinueOnError="{x:Null}" Code="AnalistaLogWrite(message);" DisplayName="Private: Invoke code" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_8" Language="CSharp">
        <ui:InvokeCode.Arguments>
          <InOutArgument x:TypeArguments="s:Action(x:String)" x:Key="AnalistaLogWrite">
            <mva:VisualBasicReference x:TypeArguments="s:Action(x:String)" ExpressionText="AnalistaLogWrite" />
          </InOutArgument>
          <InArgument x:TypeArguments="x:String" x:Key="message">
            <Literal x:TypeArguments="x:String">Criar pasta de destino</Literal>
          </InArgument>
        </ui:InvokeCode.Arguments>
      </ui:InvokeCode>
      <FlowStep.Next>
        <x:Reference>__ReferenceID44</x:Reference>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID45</x:Reference>
    <x:Reference>__ReferenceID46</x:Reference>
  </Flowchart>
</Activity>